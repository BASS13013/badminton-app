<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#047857">
    <title>Badminton Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { 
            -webkit-tap-highlight-color: transparent; 
            font-family: 'Poppins', system-ui, sans-serif;
        }
        body { 
            margin: 0;
            background: linear-gradient(135deg, #0f766e 0%, #047857 50%, #065f46 100%);
            min-height: 100vh;
        }
        .glass {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
        .match-done { background: linear-gradient(135deg, #10b981 0%, #059669 100%); opacity: 0.7; }
        .match-pending { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); }
        .badminton-icon {
            width: 120px; height: 120px;
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            margin: 0 auto 20px;
        }
        
        /* PAGE PLEIN √âCRAN POUR LES ZONES - SOLUTION TABLETTES NEUVES */
        .page-zones-fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #047857, #065f46);
            z-index: 99999;
            display: none;
            flex-direction: column;
            padding: 20px;
        }
        .page-zones-fullscreen.active {
            display: flex !important;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        console.log('üè∏ Badminton Pro - VERSION TABLETTES NEUVES (Page plein √©cran)');

        const Icon = ({d, className = "w-6 h-6"}) => <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d={d} /></svg>;
        const Users = ({className}) => <Icon className={className} d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />;
        const Target = ({className}) => <svg className={className || "w-6 h-6"} fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>;
        const Zap = ({className}) => <Icon className={className} d="M13 10V3L4 14h7v7l9-11h-7z" />;
        const MapPin = ({className}) => <Icon className={className} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />;
        const Clock = ({className}) => <svg className={className || "w-6 h-6"} fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>;
        const Trophy = ({className}) => <Icon className={className} d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />;
        const RotateCcw = ({className}) => <Icon className={className} d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6" />;
        const ChevronRight = ({className}) => <Icon className={className} d="M9 5l7 7-7 7" />;
        const Trash2 = ({className}) => <Icon className={className} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />;
        const Edit = ({className}) => <Icon className={className} d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />;
        const Save = ({className}) => <Icon className={className} d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" />;

        function BadmintonTracker() {
          const [config, setConfig] = useState({classe: '', nombreJoueurs: 0, joueurs: [], typeMatch: '', mortSubite: false, objetEnseignement: '', pointsDoubles: false});
          const [poule, setPoule] = useState([]);
          const [matchEnCours, setMatchEnCours] = useState(null);
          const [historiquePoints, setHistoriquePoints] = useState([]);
          const [timer, setTimer] = useState(180);
          const [timerActif, setTimerActif] = useState(false);
          const [phase, setPhase] = useState('classe');
          const [donnees, setDonnees] = useState({});
          const [classes, setClasses] = useState({});
          const [showDeleteModal, setShowDeleteModal] = useState(false);
          const [showTerrain, setShowTerrain] = useState(false); // 'j1', 'j2' ou false
          const [matchsTermines, setMatchsTermines] = useState([]);
          const [showEditMatch, setShowEditMatch] = useState(null);
          const [seances, setSeances] = useState({});
          const [currentSeance, setCurrentSeance] = useState(1);

          // Sauvegarde auto
          useEffect(() => {
            const interval = setInterval(() => {
              sauvegarderDonnees();
            }, 5000);
            return () => clearInterval(interval);
          }, [donnees, matchsTermines, config, seances]);

          const sauvegarderDonnees = () => {
            try {
              const dataToSave = {
                classes, config, donnees, matchsTermines, phase, poule, seances, currentSeance,
                timestamp: new Date().toISOString()
              };
              localStorage.setItem('badminton-data', JSON.stringify(dataToSave));
              localStorage.setItem('badminton-backup', JSON.stringify(dataToSave));
            } catch (e) {
              console.error('Erreur sauvegarde:', e);
            }
          };

          useEffect(() => {
            const saved = localStorage.getItem('badminton-data');
            if (saved) {
              try {
                const data = JSON.parse(saved);
                setClasses(data.classes || {});
                setConfig(data.config || config);
                setDonnees(data.donnees || {});
                setMatchsTermines(data.matchsTermines || []);
                setPhase(data.phase || 'classe');
                setPoule(data.poule || []);
                setSeances(data.seances || {});
                setCurrentSeance(data.currentSeance || 1);
              } catch(e) {}
            }
          }, []);

          useEffect(() => {
            let interval;
            if (timerActif && timer > 0) {
              interval = setInterval(() => {
                setTimer(prev => {
                  if (prev <= 1) { 
                    setTimerActif(false); 
                    alert('Temps √©coul√© !'); 
                    return 0; 
                  }
                  return prev - 1;
                });
              }, 1000);
            }
            return () => clearInterval(interval);
          }, [timerActif, timer]);

          const formatTimer = (s) => `${Math.floor(s/60)}:${(s%60).toString().padStart(2,'0')}`;

          const genererOrdreMatchs = (joueurs) => {
            const n = joueurs.length;
            const matchs = [];
            if (n === 2) {
              matchs.push([joueurs[0], joueurs[1]]);
            } else {
              const rounds = n % 2 === 0 ? n - 1 : n;
              const playersPerRound = n % 2 === 0 ? n : n + 1;
              let players = [...joueurs];
              if (n % 2 !== 0) players.push(null);
              for (let round = 0; round < rounds; round++) {
                for (let i = 0; i < playersPerRound / 2; i++) {
                  const j1 = players[i];
                  const j2 = players[playersPerRound - 1 - i];
                  if (j1 && j2) matchs.push([j1, j2]);
                }
                players = [players[0], players[playersPerRound - 1], ...players.slice(1, playersPerRound - 1)];
              }
            }
            return matchs;
          };

          const ajouterJoueur = () => {
            setConfig(prev => ({...prev, joueurs: [...prev.joueurs, { nom: `Joueur${prev.joueurs.length + 1}`, prenom: '' }]}));
          };

          const modifierJoueur = (index, field, value) => {
            const nouveaux = [...config.joueurs];
            nouveaux[index][field] = value;
            setConfig({...config, joueurs: nouveaux});
          };

          const demarrerPoule = () => {
            const nouvelleDonnees = {};
            config.joueurs.forEach(j => {
              nouvelleDonnees[`${j.prenom}_${j.nom}`] = {
                nom: j.nom, prenom: j.prenom, zonesDangereuses: 0, smashAnnonces: 0, zonesLibres: 0,
                pointsDoubles: 0, matchsJoues: 0, matchsGagnes: 0, pointsMarques: 0, pointsEncaisses: 0,
                defaitesMortSubite: 0, victoires: [], pointsTerrain: []
              };
            });
            setDonnees(nouvelleDonnees);
            setPoule(config.joueurs);
            setMatchsTermines([]);
            if (!seances[config.classe]) seances[config.classe] = {};
            if (!seances[config.classe][currentSeance]) {
              seances[config.classe][currentSeance] = { date: new Date().toISOString(), donnees: nouvelleDonnees };
            }
            setClasses(prev => ({...prev, [config.classe]: nouvelleDonnees}));
            setPhase('selection');
          };

          const getMatchKey = (j1, j2) => {
            const key1 = `${j1.prenom}_${j1.nom}`;
            const key2 = `${j2.prenom}_${j2.nom}`;
            return [key1, key2].sort().join('-vs-');
          };

          const isMatchTermine = (j1, j2) => {
            const key = getMatchKey(j1, j2);
            return matchsTermines.some(m => m.key === key);
          };

          const demarrerMatch = (j1, j2) => {
            if (isMatchTermine(j1, j2)) {
              alert('Ce match a d√©j√† √©t√© jou√©. Utilisez "Modifier".');
              return;
            }
            const pointsMax = config.typeMatch === '11pts' ? 11 : config.typeMatch === '15pts' ? 15 : 999;
            setMatchEnCours({
              joueur1: `${j1.prenom}_${j1.nom}`, joueur2: `${j2.prenom}_${j2.nom}`, 
              prenomJ1: j1.prenom, nomJ1: j1.nom, prenomJ2: j2.prenom, nomJ2: j2.nom,
              scoreJ1: 0, scoreJ2: 0, pointsDoublesJ1: 0, pointsDoublesJ2: 0,
              statsJ1: { zonesDangereuses: 0, smashAnnonces: 0, zonesLibres: 0 },
              statsJ2: { zonesDangereuses: 0, smashAnnonces: 0, zonesLibres: 0 },
              terrainJ1: [], terrainJ2: [], pointsMax, 
              changementCote: Math.floor(pointsMax / 2), coteChange: false
            });
            setHistoriquePoints([]);
            if (config.typeMatch === '3min') { setTimer(180); setTimerActif(true); }
            setPhase('jeu');
          };

          const ajouterPointAvecZone = (joueur, type, zone) => {
            setMatchEnCours(prev => {
              const nouveau = {...prev};
              const isDouble = type !== 'normal';
              setHistoriquePoints(hist => [...hist, {joueur, type, zone, etat: JSON.parse(JSON.stringify(prev))}]);

              if (joueur === 'j1') {
                nouveau.scoreJ1++;
                if (isDouble && config.pointsDoubles) nouveau.scoreJ1++;
                if (isDouble) nouveau.pointsDoublesJ1++;
                if (type === 'zoneDangereuse') nouveau.statsJ1.zonesDangereuses++;
                else if (type === 'smashAnnonce') nouveau.statsJ1.smashAnnonces++;
                else if (type === 'zoneLibre') nouveau.statsJ1.zonesLibres++;
                if (zone) nouveau.terrainJ1.push(zone);
              } else {
                nouveau.scoreJ2++;
                if (isDouble && config.pointsDoubles) nouveau.scoreJ2++;
                if (isDouble) nouveau.pointsDoublesJ2++;
                if (type === 'zoneDangereuse') nouveau.statsJ2.zonesDangereuses++;
                else if (type === 'smashAnnonce') nouveau.statsJ2.smashAnnonces++;
                else if (type === 'zoneLibre') nouveau.statsJ2.zonesLibres++;
                if (zone) nouveau.terrainJ2.push(zone);
              }

              if (config.mortSubite) {
                if (nouveau.pointsDoublesJ2 >= 3) { setTimeout(() => terminerMatch(true, 'j1'), 100); return nouveau; }
                if (nouveau.pointsDoublesJ1 >= 3) { setTimeout(() => terminerMatch(true, 'j2'), 100); return nouveau; }
              }

              if (!nouveau.coteChange && config.typeMatch !== '3min') {
                const total = nouveau.scoreJ1 + nouveau.scoreJ2;
                if (total >= nouveau.changementCote) {
                  nouveau.coteChange = true;
                  setTimeout(() => alert('üîÑ Changement de c√¥t√© !'), 100);
                }
              }

              if (config.typeMatch !== '3min') {
                if (nouveau.scoreJ1 >= nouveau.pointsMax || nouveau.scoreJ2 >= nouveau.pointsMax) {
                  setTimeout(() => terminerMatch(), 100);
                }
              }

              return nouveau;
            });
          };

          const ajouterPoint = (joueur, type) => ajouterPointAvecZone(joueur, type, null);

          const annulerDernierPoint = () => {
            if (historiquePoints.length === 0) { alert('Aucun point √† annuler'); return; }
            const dernierPoint = historiquePoints[historiquePoints.length - 1];
            setMatchEnCours(dernierPoint.etat);
            setHistoriquePoints(hist => hist.slice(0, -1));
          };

          const getIndiceReussite = (bonus, victoire) => {
            if (!victoire) return { texte: 'D√©faite', couleur: 'text-gray-600', icon: '‚ùå' };
            if (bonus >= 4) return { texte: 'Excellent', couleur: 'text-purple-600', icon: 'üèÜ' };
            if (bonus >= 3) return { texte: 'Tr√®s bien', couleur: 'text-green-600', icon: '‚≠ê' };
            if (bonus >= 2) return { texte: 'Bien', couleur: 'text-blue-600', icon: '‚úì' };
            if (bonus >= 1) return { texte: 'Assez bien', couleur: 'text-yellow-600', icon: '‚óã' };
            return { texte: 'Victoire simple', couleur: 'text-gray-600', icon: '‚Ä¢' };
          };

          const terminerMatch = (mortSubite = false, gagnant = null) => {
            if (!matchEnCours) return;
            const {joueur1, joueur2, prenomJ1, nomJ1, prenomJ2, nomJ2, scoreJ1, scoreJ2, statsJ1, statsJ2, pointsDoublesJ1, pointsDoublesJ2, terrainJ1, terrainJ2} = matchEnCours;
            const victoireJ1 = mortSubite ? gagnant === 'j1' : scoreJ1 > scoreJ2;
            const victoireJ2 = mortSubite ? gagnant === 'j2' : scoreJ2 > scoreJ1;

            const matchKey = getMatchKey({prenom: prenomJ1, nom: nomJ1}, {prenom: prenomJ2, nom: nomJ2});
            setMatchsTermines(prev => [...prev, {
              key: matchKey, j1: joueur1, j2: joueur2, scoreJ1, scoreJ2, statsJ1, statsJ2,
              pointsDoublesJ1, pointsDoublesJ2, victoireJ1, mortSubite, date: new Date().toISOString()
            }]);

            setDonnees(prev => {
              const nouveau = {...prev};
              nouveau[joueur1].matchsJoues++;
              nouveau[joueur1].pointsMarques += scoreJ1;
              nouveau[joueur1].pointsEncaisses += scoreJ2;
              nouveau[joueur1].zonesDangereuses += statsJ1.zonesDangereuses;
              nouveau[joueur1].smashAnnonces += statsJ1.smashAnnonces;
              nouveau[joueur1].zonesLibres += statsJ1.zonesLibres;
              nouveau[joueur1].pointsDoubles += pointsDoublesJ1;
              nouveau[joueur1].pointsTerrain.push(...terrainJ1);
              if (victoireJ1) {
                nouveau[joueur1].matchsGagnes++;
                nouveau[joueur1].victoires.push({
                  adversaire: `${prenomJ2} ${nomJ2}`, score: `${scoreJ1}-${scoreJ2}`,
                  bonus: pointsDoublesJ1, indice: getIndiceReussite(pointsDoublesJ1, true)
                });
              } else if (mortSubite) nouveau[joueur1].defaitesMortSubite++;

              nouveau[joueur2].matchsJoues++;
              nouveau[joueur2].pointsMarques += scoreJ2;
              nouveau[joueur2].pointsEncaisses += scoreJ1;
              nouveau[joueur2].zonesDangereuses += statsJ2.zonesDangereuses;
              nouveau[joueur2].smashAnnonces += statsJ2.smashAnnonces;
              nouveau[joueur2].zonesLibres += statsJ2.zonesLibres;
              nouveau[joueur2].pointsDoubles += pointsDoublesJ2;
              nouveau[joueur2].pointsTerrain.push(...terrainJ2);
              if (victoireJ2) {
                nouveau[joueur2].matchsGagnes++;
                nouveau[joueur2].victoires.push({
                  adversaire: `${prenomJ1} ${nomJ1}`, score: `${scoreJ2}-${scoreJ1}`,
                  bonus: pointsDoublesJ2, indice: getIndiceReussite(pointsDoublesJ2, true)
                });
              } else if (mortSubite) nouveau[joueur2].defaitesMortSubite++;
              return nouveau;
            });

            if (seances[config.classe]?.[currentSeance]) {
              seances[config.classe][currentSeance].donnees = donnees;
            }
            setClasses(prev => ({...prev, [config.classe]: donnees}));
            setTimerActif(false);
            setMatchEnCours(null);
            setHistoriquePoints([]);
            setPhase('selection');
            sauvegarderDonnees();
          };

          const modifierMatch = (match) => {
            setShowEditMatch(match);
          };

          const sauvegarderModificationMatch = (newScoreJ1, newScoreJ2) => {
            setDonnees(prev => {
              const nouveau = {...prev};
              const match = showEditMatch;
              nouveau[match.j1].pointsMarques -= match.scoreJ1;
              nouveau[match.j1].pointsEncaisses -= match.scoreJ2;
              nouveau[match.j2].pointsMarques -= match.scoreJ2;
              nouveau[match.j2].pointsEncaisses -= match.scoreJ1;
              nouveau[match.j1].pointsMarques += newScoreJ1;
              nouveau[match.j1].pointsEncaisses += newScoreJ2;
              nouveau[match.j2].pointsMarques += newScoreJ2;
              nouveau[match.j2].pointsEncaisses += newScoreJ1;
              const nouvelleVictoireJ1 = newScoreJ1 > newScoreJ2;
              const ancienneVictoireJ1 = match.victoireJ1;
              if (nouvelleVictoireJ1 !== ancienneVictoireJ1) {
                if (nouvelleVictoireJ1) {
                  nouveau[match.j1].matchsGagnes++;
                  nouveau[match.j2].matchsGagnes--;
                } else {
                  nouveau[match.j1].matchsGagnes--;
                  nouveau[match.j2].matchsGagnes++;
                }
              }
              return nouveau;
            });
            setMatchsTermines(prev => prev.map(m => 
              m.key === showEditMatch.key 
                ? {...m, scoreJ1: newScoreJ1, scoreJ2: newScoreJ2, victoireJ1: newScoreJ1 > newScoreJ2}
                : m
            ));
            setShowEditMatch(null);
            sauvegarderDonnees();
          };

          // SIMPLIFICATION : Juste les phases essentielles pour le test
          if (phase === 'classe') {
            return (
              <div className="min-h-screen p-4">
                <div className="max-w-2xl mx-auto">
                  <div className="glass rounded-3xl shadow-2xl p-8">
                    <div className="text-center mb-8">
                      <div className="badminton-icon">üè∏</div>
                      <h1 className="text-5xl font-extrabold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent mb-2">
                        Badminton Pro
                      </h1>
                      <p className="text-gray-600 font-medium">Version TABLETTES NEUVES</p>
                      <p className="text-xs text-emerald-600 mt-2">‚úì Page plein √©cran pour les zones</p>
                    </div>
                    <div className="mb-6">
                      <label className="block text-sm font-bold text-gray-700 mb-3">üìö Nom de la classe</label>
                      <input 
                        type="text" 
                        value={config.classe} 
                        onChange={(e) => setConfig({...config, classe: e.target.value})}
                        className="w-full px-5 py-4 border-2 border-emerald-300 rounded-xl focus:border-emerald-500 focus:outline-none text-lg font-medium shadow-sm"
                        placeholder="Ex: 3√®me A" 
                      />
                    </div>
                    <button 
                      onClick={() => setPhase('config')} 
                      disabled={!config.classe.trim()}
                      className="w-full bg-gradient-to-r from-emerald-600 to-teal-600 text-white py-4 rounded-xl font-bold text-lg hover:from-emerald-700 hover:to-teal-700 disabled:from-gray-300 disabled:to-gray-400 transition shadow-lg"
                    >
                      Continuer ‚Üí
                    </button>
                  </div>
                </div>
              </div>
            );
          }

          if (phase === 'config') {
            return (
              <div className="min-h-screen p-4">
                <div className="max-w-2xl mx-auto">
                  <div className="glass rounded-3xl shadow-2xl p-8">
                    <h1 className="text-3xl font-bold text-center mb-6">{config.classe}</h1>
                    {config.nombreJoueurs === 0 ? (
                      <div>
                        <p className="text-center font-bold mb-6">Nombre d'√©l√®ves ?</p>
                        <div className="grid grid-cols-4 gap-3">
                          {[2, 3, 4, 5].map(nb => (
                            <button 
                              key={nb} 
                              onClick={() => {
                                setConfig({...config, nombreJoueurs: nb, joueurs: []});
                                for (let i = 0; i < nb; i++) setTimeout(() => ajouterJoueur(), i * 50);
                              }}
                              className="bg-gradient-to-br from-emerald-500 to-teal-500 text-white py-8 rounded-2xl font-bold text-3xl hover:shadow-xl transition"
                            >
                              {nb}
                            </button>
                          ))}
                        </div>
                      </div>
                    ) : (
                      <div>
                        <div className="space-y-3 mb-6">
                          {config.joueurs.map((joueur, index) => (
                            <div key={index} className="grid grid-cols-2 gap-2">
                              <input 
                                type="text" 
                                value={joueur.prenom} 
                                onChange={(e) => modifierJoueur(index, 'prenom', e.target.value)}
                                className="px-4 py-3 border-2 border-emerald-300 rounded-xl focus:border-emerald-500 focus:outline-none"
                                placeholder="Pr√©nom" 
                              />
                              <input 
                                type="text" 
                                value={joueur.nom} 
                                onChange={(e) => modifierJoueur(index, 'nom', e.target.value)}
                                className="px-4 py-3 border-2 border-emerald-300 rounded-xl focus:border-emerald-500 focus:outline-none"
                                placeholder="Nom" 
                              />
                            </div>
                          ))}
                        </div>
                        <div className="flex gap-3">
                          <button 
                            onClick={() => setConfig({...config, nombreJoueurs: 0, joueurs: []})} 
                            className="flex-1 bg-gray-500 text-white py-4 rounded-xl font-bold"
                          >
                            ‚Üê Retour
                          </button>
                          <button 
                            onClick={() => {
                              // Config rapide pour test
                              setConfig({
                                ...config,
                                objetEnseignement: 'zones',
                                typeMatch: '11pts',
                                pointsDoubles: true,
                                mortSubite: false
                              });
                              demarrerPoule();
                            }} 
                            disabled={config.joueurs.some(j => !j.nom.trim() || !j.prenom.trim())}
                            className="flex-1 bg-gradient-to-r from-emerald-600 to-teal-600 text-white py-4 rounded-xl font-bold disabled:from-gray-300"
                          >
                            D√©marrer test ‚Üí
                          </button>
                        </div>
                      </div>
                    )}
                  </div>
                </div>
              </div>
            );
          }

          if (phase === 'selection') {
            const matchsOrdonnes = genererOrdreMatchs(poule);
            return (
              <div className="min-h-screen p-4">
                <div className="max-w-4xl mx-auto">
                  <div className="glass rounded-3xl p-6 mb-6">
                    <h2 className="text-2xl font-bold mb-4">{config.classe}</h2>
                    <div className="grid gap-3">
                      {matchsOrdonnes.map((match, index) => {
                        const [j1, j2] = match;
                        const estTermine = isMatchTermine(j1, j2);
                        const matchKey = getMatchKey(j1, j2);
                        const matchData = matchsTermines.find(m => m.key === matchKey);

                        return (
                          <div key={index} className={`${estTermine ? 'match-done' : 'match-pending'} text-white p-4 rounded-xl flex items-center justify-between`}>
                            <div className="flex items-center gap-3">
                              <div className="bg-white text-gray-800 rounded-full w-8 h-8 flex items-center justify-center font-bold">
                                {index + 1}
                              </div>
                              <span className="font-bold">
                                {j1.prenom} vs {j2.prenom}
                              </span>
                            </div>
                            {estTermine ? (
                              <span className="font-bold">‚úì {matchData.scoreJ1}-{matchData.scoreJ2}</span>
                            ) : (
                              <button
                                onClick={() => demarrerMatch(j1, j2)}
                                className="bg-white text-blue-600 px-5 py-2 rounded-lg font-bold"
                              >
                                Jouer
                              </button>
                            )}
                          </div>
                        );
                      })}
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          if (phase === 'jeu' && matchEnCours) {
            return (
              <div className="min-h-screen p-4">
                <div className="max-w-6xl mx-auto">
                  <div className="glass rounded-3xl p-8 mb-6">
                    <div className="grid grid-cols-3 gap-6 items-center mb-6">
                      <div className="text-center">
                        <h3 className="text-2xl font-bold mb-3 text-blue-600">{matchEnCours.prenomJ1}</h3>
                        <div className="text-7xl font-extrabold text-blue-600">{matchEnCours.scoreJ1}</div>
                      </div>
                      <div className="text-center text-5xl font-extrabold text-gray-400">VS</div>
                      <div className="text-center">
                        <h3 className="text-2xl font-bold mb-3 text-red-600">{matchEnCours.prenomJ2}</h3>
                        <div className="text-7xl font-extrabold text-red-600">{matchEnCours.scoreJ2}</div>
                      </div>
                    </div>
                  </div>

                  <div className="grid md:grid-cols-2 gap-6 mb-6">
                    <div className="glass rounded-2xl p-6">
                      <h3 className="text-xl font-bold text-blue-600 mb-4">{matchEnCours.prenomJ1}</h3>
                      <div className="space-y-3">
                        <button 
                          onClick={() => ajouterPoint('j1', 'normal')} 
                          className="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-5 rounded-xl font-bold"
                        >
                          Point normal (+1)
                        </button>
                        <button 
                          onClick={() => setShowTerrain('j1')}
                          className="w-full bg-gradient-to-r from-orange-500 to-red-500 text-white py-5 rounded-xl font-bold"
                        >
                          Zone dangereuse (+{config.pointsDoubles ? '2' : '1'})
                        </button>
                      </div>
                    </div>

                    <div className="glass rounded-2xl p-6">
                      <h3 className="text-xl font-bold text-red-600 mb-4">{matchEnCours.prenomJ2}</h3>
                      <div className="space-y-3">
                        <button 
                          onClick={() => ajouterPoint('j2', 'normal')} 
                          className="w-full bg-gradient-to-r from-red-500 to-red-600 text-white py-5 rounded-xl font-bold"
                        >
                          Point normal (+1)
                        </button>
                        <button 
                          onClick={() => setShowTerrain('j2')}
                          className="w-full bg-gradient-to-r from-orange-500 to-red-500 text-white py-5 rounded-xl font-bold"
                        >
                          Zone dangereuse (+{config.pointsDoubles ? '2' : '1'})
                        </button>
                      </div>
                    </div>
                  </div>

                  <div className="grid md:grid-cols-2 gap-4">
                    <button 
                      onClick={() => { if (confirm('Terminer ?')) terminerMatch(); }}
                      className="bg-gradient-to-r from-emerald-600 to-teal-600 text-white py-5 rounded-xl font-bold"
                    >
                      ‚úì Terminer
                    </button>
                    <button 
                      onClick={annulerDernierPoint} 
                      className="bg-gradient-to-r from-orange-500 to-orange-600 text-white py-5 rounded-xl font-bold"
                    >
                      ‚Üê Annuler ({historiquePoints.length})
                    </button>
                  </div>
                </div>

                {/* PAGE PLEIN √âCRAN POUR LES ZONES - LA SOLUTION ! */}
                <div className={`page-zones-fullscreen ${showTerrain ? 'active' : ''}`}>
                  <div style={{color: 'white', textAlign: 'center', fontSize: '24px', fontWeight: 'bold', marginBottom: '20px'}}>
                    üè∏ S√©lectionnez la zone
                  </div>
                  
                  <div style={{flex: 1, display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '15px', marginBottom: '15px'}}>
                    <button 
                      onClick={() => { ajouterPointAvecZone(showTerrain, 'zoneDangereuse', 1); setShowTerrain(false); }}
                      style={{
                        background: 'linear-gradient(135deg, #10b981, #059669)',
                        color: 'white',
                        border: 'none',
                        borderRadius: '15px',
                        fontSize: '16px',
                        fontWeight: 'bold',
                        padding: '20px',
                        minHeight: '140px',
                        display: 'flex',
                        flexDirection: 'column',
                        alignItems: 'center',
                        justifyContent: 'center',
                        gap: '8px'
                      }}
                    >
                      <div style={{fontSize: '40px'}}>‚¨ÜÔ∏è</div>
                      <div>Avant Gauche</div>
                      <div style={{fontSize: '36px', fontWeight: 'bold'}}>1</div>
                    </button>
                    
                    <button 
                      onClick={() => { ajouterPointAvecZone(showTerrain, 'zoneDangereuse', 2); setShowTerrain(false); }}
                      style={{
                        background: 'linear-gradient(135deg, #10b981, #059669)',
                        color: 'white',
                        border: 'none',
                        borderRadius: '15px',
                        fontSize: '16px',
                        fontWeight: 'bold',
                        padding: '20px',
                        minHeight: '140px',
                        display: 'flex',
                        flexDirection: 'column',
                        alignItems: 'center',
                        justifyContent: 'center',
                        gap: '8px'
                      }}
                    >
                      <div style={{fontSize: '40px'}}>‚¨ÜÔ∏è</div>
                      <div>Avant Droite</div>
                      <div style={{fontSize: '36px', fontWeight: 'bold'}}>2</div>
                    </button>
                    
                    <button 
                      onClick={() => { ajouterPointAvecZone(showTerrain, 'zoneDangereuse', 3); setShowTerrain(false); }}
                      style={{
                        background: 'linear-gradient(135deg, #047857, #065f46)',
                        color: 'white',
                        border: 'none',
                        borderRadius: '15px',
                        fontSize: '16px',
                        fontWeight: 'bold',
                        padding: '20px',
                        minHeight: '140px',
                        display: 'flex',
                        flexDirection: 'column',
                        alignItems: 'center',
                        justifyContent: 'center',
                        gap: '8px'
                      }}
                    >
                      <div style={{fontSize: '40px'}}>‚¨áÔ∏è</div>
                      <div>Arri√®re Gauche</div>
                      <div style={{fontSize: '36px', fontWeight: 'bold'}}>3</div>
                    </button>
                    
                    <button 
                      onClick={() => { ajouterPointAvecZone(showTerrain, 'zoneDangereuse', 4); setShowTerrain(false); }}
                      style={{
                        background: 'linear-gradient(135deg, #047857, #065f46)',
                        color: 'white',
                        border: 'none',
                        borderRadius: '15px',
                        fontSize: '16px',
                        fontWeight: 'bold',
                        padding: '20px',
                        minHeight: '140px',
                        display: 'flex',
                        flexDirection: 'column',
                        alignItems: 'center',
                        justifyContent: 'center',
                        gap: '8px'
                      }}
                    >
                      <div style={{fontSize: '40px'}}>‚¨áÔ∏è</div>
                      <div>Arri√®re Droite</div>
                      <div style={{fontSize: '36px', fontWeight: 'bold'}}>4</div>
                    </button>
                  </div>
                  
                  <button 
                    onClick={() => setShowTerrain(false)}
                    style={{
                      width: '100%',
                      background: '#6b7280',
                      color: 'white',
                      border: 'none',
                      padding: '20px',
                      borderRadius: '15px',
                      fontSize: '18px',
                      fontWeight: 'bold'
                    }}
                  >
                    ‚úï Annuler
                  </button>
                </div>
              </div>
            );
          }

          return null;
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<BadmintonTracker />);
        console.log('‚úÖ VERSION TABLETTES NEUVES - Page plein √©cran activ√©e');
    </script>
</body>
</html>
